<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('../partials/head') %>
  <title><%= typeof title !== 'undefined' ? title : (fn?.event_name || 'Function') %></title>

  <!-- Styles used by function detail pages (e.g., comms cards) -->
  <link rel="stylesheet" href="/css/inbox.css">
  <!-- Quill CSS (editor) -->
  <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
</head>
<body>
  <!-- Global header -->
  <%- include('../partials/header', { active: 'functions', user }) %>

  <main class="function-layout-two-col" style="padding-top: 6rem;">
    <!-- Sidebar -->
    <aside class="function-sidebar">
      <%- include('../partials/sidebar', { 
        fn, 
        linkedContacts: linkedContacts || [], 
        rooms: rooms || [], 
        eventTypes: eventTypes || [] 
      }) %>
    </aside>

    <!-- Workspace with tabs -->
    <section class="function-workspace">
      <%- include('../partials/function-tabs', { fn, activeTab: activeTab || '' }) %>
      <div class="container py-3">
        <%- body %>
      </div>
    </section>
  </main>

  <!-- Panels/overlay used by the sidebar -->
  <%- include('../partials/function-modals') %>

  <!-- Vendor JS (once) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
  <!-- Quill JS (editor) -->
  <script src="https://cdn.quilljs.com/1.3.7/quill.min.js" defer></script>

  <!-- Sidebar behaviour (if you already have this file) -->
  <script src="/js/sidebar.js" defer></script>
</body>
</html>

